{
    // 日志配置 (Log Configuration)
    "log": {
        "level": "notify",
        "timestamp": true
    },
    // DNS 配置 (DNS Configuration)
    "dns": {
        "servers": [
            {
                "tag": "ali-dns",
                "address": "223.5.5.5",
                "detour": "DIRECT"
            },
            {
                "tag": "dnspod-dns",
                "address": "119.29.29.29",
                "detour": "DIRECT"
            },
            {
                "tag": "google-dns-hijack",
                "address": "8.8.8.8",
                "detour": "DIRECT"
            },
            {
                "tag": "google-dns-alt-hijack",
                "address": "8.8.4.4",
                "detour": "DIRECT"
            },
            {
                "address": "rcode://success"
            }
        ],
        "rules": [
            {
                "domain": [
                    "taobao.com",
                    "tmall.com"
                ],
                "domain_suffix": [
                    ".taobao.com",
                    ".tmall.com"
                ],
                "server": "ali-dns"
            },
            {
                "domain": [
                    "jd.com",
                    "qq.com",
                    "tencent.com",
                    "weixin.com",
                    "bilibili.com",
                    "163.com",
                    "126.com",
                    "netease.com",
                    "mi.com",
                    "xiaomi.com"
                ],
                "domain_suffix": [
                    ".jd.com",
                    ".qq.com",
                    ".tencent.com",
                    ".weixin.com",
                    ".bilibili.com",
                    ".hdslb.com",
                    ".163.com",
                    ".126.com",
                    ".126.net",
                    ".127.net",
                    ".netease.com",
                    ".mi.com",
                    ".xiaomi.com"
                ],
                "server": "dnspod-dns"
            },
            {
                "domain_suffix": [
                    ".alicdn.com",
                    ".aliyun.com"
                ],
                "domain": [
                    "aliyun.com"
                ],
                "server": "ali-dns"
            },
            {
                "query_type": [
                    "A",
                    "AAAA"
                ],
                "server": "google-dns-hijack"
            },
            {
                "domain_regex": "^[^.]*$",
                "server": "dnspod-dns"
            }
        ],
        "strategy": "ipv4_only",
        "disable_cache": false
    },
    // 入站连接配置 (Inbound Connection Configuration)
    "inbounds": [
        {
            "tag": "http-in",
            "type": "http",
            "listen": "0.0.0.0",
            "listen_port": 1080,
            "sniff": true,
            "sniff_override_destination": true
        },
        {
            "tag": "socks-in",
            "type": "socks",
            "listen": "0.0.0.0",
            "listen_port": 1081,
            "sniff": true,
            "sniff_override_destination": true
        }
    ],
    // 出站连接配置 (Outbound Connection Configuration)
    // !!! 注意：脚本会填充这里的策略组和添加节点 !!!
    "outbounds": [
        // --- 基础出站 ---
        {
            "tag": "DIRECT",
            "type": "direct"
        },
        {
            "tag": "REJECT",
            "type": "block"
        },
        {
            "tag": "DNS-OUT",
            "type": "dns"
        },
        // --- Fallback (脚本在需要时添加) ---
        // { "tag": "Fallback", "type": "direct" }, // 脚本可能会添加类似这个的备用出口
        // --- 策略组骨架 (脚本将填充 'outbounds' 数组) ---
        // 地区分组 (urltest)
        {
            "tag": "🇭🇰 香港节点",
            "type": "urltest",
            "outbounds": [],
            "url": "http://www.gstatic.com/generate_204",
            "interval": "300s",
            "tolerance": 150,
            "interrupt_exist_connections": false
        },
        {
            "tag": "🇨🇳 台湾节点",
            "type": "urltest",
            "outbounds": [],
            "url": "http://www.gstatic.com/generate_204",
            "interval": "300s",
            "tolerance": 150,
            "interrupt_exist_connections": false
        },
        {
            "tag": "🇯🇵 日本节点",
            "type": "urltest",
            "outbounds": [],
            "url": "http://www.gstatic.com/generate_204",
            "interval": "300s",
            "tolerance": 150,
            "interrupt_exist_connections": false
        },
        {
            "tag": "🇸🇬 狮城节点",
            "type": "urltest",
            "outbounds": [],
            "url": "http://www.gstatic.com/generate_204",
            "interval": "300s",
            "tolerance": 150,
            "interrupt_exist_connections": false
        },
        // 地区分组 (selector) - 注意：selector需要默认值，脚本填充后需要处理
        {
            "tag": "🇺🇲 美国节点",
            "type": "selector",
            "outbounds": [],
            "default": ""
        }, // default 会被脚本处理
        {
            "tag": "🇰🇷 韩国节点",
            "type": "selector",
            "outbounds": [],
            "default": ""
        },
        {
            "tag": "🌐 其他节点",
            "type": "selector",
            "outbounds": [],
            "default": ""
        },
        // 手动和自动选择组
        {
            "tag": "♻️ 自动选择",
            "type": "urltest",
            "outbounds": [],
            "url": "http://www.gstatic.com/generate_204",
            "interval": "300s",
            "tolerance": 50,
            "interrupt_exist_connections": false
        },
        {
            "tag": "🚀 手动切换",
            "type": "selector",
            "outbounds": [],
            "default": ""
        },
        // 主选择器 (包含其他策略组和 DIRECT)
        {
            "tag": "🪜 Proxy", // 使用这个作为主要的代理选择器，路由规则需要指向它
            "type": "selector",
            "outbounds": [ // 脚本会根据实际生成的组来调整这个列表
                "♻️ 自动选择",
                "🚀 手动切换",
                "🇭🇰 香港节点",
                "🇨🇳 台湾节点",
                "🇸🇬 狮城节点",
                "🇯🇵 日本节点",
                "🇺🇲 美国节点",
                "🇰🇷 韩国节点",
                "🌐 其他节点",
                "DIRECT"
            ],
            "default": "♻️ 自动选择" // 默认值可能需要脚本根据是否有节点来调整
        },
        // 媒体/服务分流组 (引用上面的组，脚本不需要填充这些，但需要确保引用的组名正确)
        {
            "tag": "📹 油管视频",
            "type": "selector",
            "outbounds": [
                "🪜 Proxy",
                "♻️ 自动选择",
                "🇭🇰 香港节点",
                "🇨🇳 台湾节点",
                "🇸🇬 狮城节点",
                "🇯🇵 日本节点",
                "🇺🇲 美国节点",
                "🇰🇷 韩国节点",
                "🌐 其他节点",
                "🚀 手动切换",
                "DIRECT"
            ],
            "default": "🪜 Proxy"
        },
        {
            "tag": "🎥 奈飞视频",
            "type": "selector",
            "outbounds": [
                "🪜 Proxy",
                "🇸🇬 狮城节点",
                "🇭🇰 香港节点",
                "🇨🇳 台湾节点",
                "🇯🇵 日本节点",
                "🇺🇲 美国节点",
                "🇰🇷 韩国节点",
                "🌐 其他节点",
                "🚀 手动切换",
                "DIRECT"
            ],
            "default": "🪜 Proxy"
        },
        {
            "tag": "📺 巴哈姆特",
            "type": "selector",
            "outbounds": [
                "🇨🇳 台湾节点",
                "🪜 Proxy",
                "🌐 其他节点",
                "🚀 手动切换",
                "DIRECT"
            ],
            "default": "🇨🇳 台湾节点"
        },
        {
            "tag": "📺 哔哩哔哩",
            "type": "selector",
            "outbounds": [
                "🎯 全球直连",
                "🇨🇳 台湾节点",
                "🇭🇰 香港节点",
                "🌐 其他节点"
            ],
            "default": "🎯 全球直连"
        }, // 需要 "🎯 全球直连" 组
        {
            "tag": "🌍 国外媒体",
            "type": "selector",
            "outbounds": [
                "🪜 Proxy",
                "♻️ 自动选择",
                "🇭🇰 香港节点",
                "🇨🇳 台湾节点",
                "🇸🇬 狮城节点",
                "🇯🇵 日本节点",
                "🇺🇲 美国节点",
                "🇰🇷 韩国节点",
                "🌐 其他节点",
                "🚀 手动切换",
                "DIRECT"
            ],
            "default": "🪜 Proxy"
        },
        {
            "tag": "🌏 国内媒体",
            "type": "selector",
            "outbounds": [
                "DIRECT",
                "🇭🇰 香港节点",
                "🇨🇳 台湾节点",
                "🇸🇬 狮城节点",
                "🇯🇵 日本节点",
                "🌐 其他节点",
                "🚀 手动切换"
            ],
            "default": "DIRECT"
        },
        {
            "tag": "📲 电报消息",
            "type": "selector",
            "outbounds": [
                "🪜 Proxy",
                "♻️ 自动选择",
                "🇸🇬 狮城节点",
                "🇭🇰 香港节点",
                "🇨🇳 台湾节点",
                "🇯🇵 日本节点",
                "🇺🇲 美国节点",
                "🇰🇷 韩国节点",
                "🌐 其他节点",
                "🚀 手动切换",
                "DIRECT"
            ],
            "default": "🪜 Proxy"
        },
        {
            "tag": "💬 OpenAi",
            "type": "selector",
            "outbounds": [
                "🪜 Proxy",
                "♻️ 自动选择",
                "🇸🇬 狮城节点",
                "🇭🇰 香港节点",
                "🇨🇳 台湾节点",
                "🇯🇵 日本节点",
                "🇺🇲 美国节点",
                "🇰🇷 韩国节点",
                "🌐 其他节点",
                "🚀 手动切换",
                "DIRECT"
            ],
            "default": "🪜 Proxy"
        },
        {
            "tag": "📢 谷歌FCM",
            "type": "selector",
            "outbounds": [
                "DIRECT",
                "🪜 Proxy",
                "🇺🇲 美国节点",
                "🇭🇰 香港节点",
                "🇨🇳 台湾节点",
                "🇸🇬 狮城节点",
                "🇯🇵 日本节点",
                "🇰🇷 韩国节点",
                "🌐 其他节点",
                "🚀 手动切换"
            ],
            "default": "DIRECT"
        },
        {
            "tag": "Ⓜ️ 微软服务",
            "type": "selector",
            "outbounds": [
                "DIRECT",
                "🪜 Proxy",
                "🇺🇲 美国节点",
                "🇭🇰 香港节点",
                "🇨🇳 台湾节点",
                "🇸🇬 狮城节点",
                "🇯🇵 日本节点",
                "🇰🇷 韩国节点",
                "🌐 其他节点",
                "🚀 手动切换"
            ],
            "default": "DIRECT"
        },
        {
            "tag": "🍎 苹果服务",
            "type": "selector",
            "outbounds": [
                "DIRECT",
                "🪜 Proxy",
                "🇺🇲 美国节点",
                "🇭🇰 香港节点",
                "🇨🇳 台湾节点",
                "🇸🇬 狮城节点",
                "🇯🇵 日本节点",
                "🇰🇷 韩国节点",
                "🌐 其他节点",
                "🚀 手动切换"
            ],
            "default": "DIRECT"
        },
        {
            "tag": "🎮 游戏平台",
            "type": "selector",
            "outbounds": [
                "DIRECT",
                "🪜 Proxy",
                "🇺🇲 美国节点",
                "🇭🇰 香港节点",
                "🇨🇳 台湾节点",
                "🇸🇬 狮城节点",
                "🇯🇵 日本节点",
                "🇰🇷 韩国节点",
                "🌐 其他节点",
                "🚀 手动切换"
            ],
            "default": "DIRECT"
        },
        // 功能性分组
        {
            "tag": "🎯 全球直连",
            "type": "selector",
            "outbounds": [
                "DIRECT",
                "🪜 Proxy",
                "♻️ 自动选择"
            ],
            "default": "DIRECT"
        }, // 这个组通常不需要脚本填充
        {
            "tag": "🛑 广告拦截",
            "type": "selector",
            "outbounds": [
                "REJECT",
                "DIRECT"
            ],
            "default": "REJECT"
        }, // 这个组不需要脚本填充
        {
            "tag": "🍃 应用净化",
            "type": "selector",
            "outbounds": [
                "REJECT",
                "DIRECT"
            ],
            "default": "REJECT"
        } // 这个组不需要脚本填充
  
      // 注意：你原始配置中的 "🐟 漏网之鱼" 被替换为了 "🪜 Proxy" 作为最终路由。
        // 如果你需要 "🐟 漏网之鱼"，可以在 route.rules 最后指向 "🪜 Proxy"，
        // 或者修改脚本参数/模板，生成名为 "🐟 漏网之鱼" 的主选择器。
    ],
    // 路由规则 (Routing Rules) - 保持不变，但确保引用的 outbound tag 正确
    "route": {
        "geoip": {
            "path": "geoip.db",
            "download_url": "https://github.com/Hackl0us/GeoIP2-CN/raw/release/Country.mmdb",
            "download_detour": "DIRECT"
        },
        "geosite": {
            "path": "geosite.db",
            "download_url": "https://github.com/SagerNet/sing-geosite/releases/latest/download/geosite.db",
            "download_detour": "DIRECT"
        },
        "rules": [
            {
                "ip_cidr": [
                    "127.0.0.1/32",
                    "::1/128",
                    "192.168.0.0/16",
                    "10.0.0.0/8",
                    "172.16.0.0/12",
                    "100.64.0.0/10",
                    "17.0.0.0/8",
                    "fc00::/7",
                    "fe80::/10"
                ],
                "outbound": "DIRECT"
            },
            {
                "domain_suffix": [
                    ".local"
                ],
                "outbound": "DIRECT"
            },
            {
                "domain_suffix": [
                    ".srv.nintendo.net",
                    ".stun.playstation.net",
                    ".xboxlive.com",
                    ".battlenet.com.cn",
                    ".battlenet.com",
                    ".blzstatic.cn",
                    ".battle.net"
                ],
                "domain_keyword": [
                    "xbox."
                ],
                "outbound": "DIRECT"
            }, // always-real-ip
            // --- 规则集引用 ---
            {
                "rule_set": "adblock-rules",
                "outbound": "🛑 广告拦截"
            },
            {
                "rule_set": "netflix-rules",
                "outbound": "🎥 奈飞视频"
            },
            {
                "rule_set": "youtube-rules",
                "outbound": "📹 油管视频"
            },
            {
                "rule_set": "bahamut-rules",
                "outbound": "📺 巴哈姆特"
            },
            {
                "rule_set": "bilibili-rules",
                "outbound": "📺 哔哩哔哩"
            },
            {
                "rule_set": [
                    "bilibili-rules-asia",
                    "iq-rules",
                    "iqiyi-rules",
                    "letv-rules",
                    "moo-rules",
                    "tencentvideo-rules",
                    "youku-rules",
                    "foxplus-rules",
                    "hulujapan-rules",
                    "japonx-rules",
                    "joox-rules",
                    "kkbox-rules",
                    "kktv-rules",
                    "linetv-rules",
                    "mytvsuper-rules",
                    "niconico-rules",
                    "viutv-rules"
                ],
                "outbound": "🌏 国内媒体"
            },
            {
                "rule_set": [
                    "abc-rules",
                    "amazon-rules",
                    "bbciplayer-rules",
                    "dazn-rules",
                    "discoveryplus-rules",
                    "encoretvb-rules",
                    "f1tv-rules",
                    "foxnow-rules",
                    "hulu-rules",
                    "pandora-rules",
                    "pbs-rules",
                    "pornhub-rules",
                    "soundcloud-rules"
                ],
                "outbound": "🌍 国外媒体"
            },
            {
                "rule_set": [
                    "applemusic-rules",
                    "applenews-rules",
                    "appletv-rules",
                    "apple-rules"
                ],
                "outbound": "🍎 苹果服务"
            },
            {
                "rule_set": "telegram-rules",
                "outbound": "📲 电报消息"
            },
            {
                "rule_set": "crypto-rules",
                "outbound": "🪜 Proxy"
            },
            {
                "rule_set": "discord-rules",
                "outbound": "🪜 Proxy"
            },
            {
                "rule_set": "googlefcm-rules",
                "outbound": "📢 谷歌FCM"
            },
            {
                "rule_set": "microsoft-rules",
                "outbound": "Ⓜ️ 微软服务"
            },
            {
                "rule_set": "ai-suite-rules",
                "outbound": "💬 OpenAi"
            },
            {
                "rule_set": "paypal-rules",
                "outbound": "🪜 Proxy"
            },
            {
                "rule_set": "scholar-rules",
                "outbound": "🪜 Proxy"
            },
            {
                "rule_set": "speedtest-rules",
                "outbound": "🪜 Proxy"
            },
            {
                "rule_set": "steam-rules",
                "outbound": "🎮 游戏平台"
            },
            {
                "rule_set": "proxy-rules",
                "outbound": "🪜 Proxy"
            },
            {
                "rule_set": [
                    "domestic-rules",
                    "domestic-ips-rules"
                ],
                "outbound": "🎯 全球直连"
            },
            // --- 地理和最终规则 ---
            {
                "network": "lan",
                "outbound": "DIRECT"
            },
            {
                "geoip": [
                    "cn"
                ],
                "outbound": "🎯 全球直连"
            },
            {
                "match": "all",
                "outbound": "🪜 Proxy"
            } // 最终规则指向主代理选择器
        ],
        // 规则集定义
        "rule_set": [
            // ... (保持你原来的 rule_set 定义不变) ...
            {
                "tag": "adblock-rules",
                "type": "remote",
                "format": "source",
                "url": "https://testingcf.jsdelivr.net/gh/dler-io/Rules@main/Surge/Surge%203/Provider/AdBlock.list",
                "download_detour": "DIRECT",
                "update_interval": "24h"
            },
            {
                "tag": "netflix-rules",
                "type": "remote",
                "format": "source",
                "url": "https://testingcf.jsdelivr.net/gh/dler-io/Rules@main/Surge/Surge%203/Provider/Media/Netflix.list",
                "download_detour": "DIRECT",
                "update_interval": "24h"
            },
            // ... (省略其他规则集定义，请确保它们都在这里) ...
            {
                "tag": "domestic-ips-rules",
                "type": "remote",
                "format": "source",
                "url": "https://testingcf.jsdelivr.net/gh/dler-io/Rules@main/Surge/Surge%203/Provider/Domestic%20IPs.list",
                "download_detour": "DIRECT",
                "update_interval": "24h"
            }
        ]
    }
}